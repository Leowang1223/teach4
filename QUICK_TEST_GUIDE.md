# 🎯 快速測試指南 - 新 API Key (2025-10-18)

## ✅ 已完成配置

1. **✅ 新 API Key 已設置**
   - 新 Key: `AIzaSyBczY1Xv_GjgVEAMQ1jbWp9QPBfIlZAyjc`
   - 文件: `apps/backend/.env`
   - 狀態: 已保存並重啟

2. **✅ 所有修復已應用**
   - Gemini 1.5 Flash (避免配額限制)
   - 速率限制保護 (3秒間隔)
   - 模組化評分系統 (5個函數)
   - 槽位檢查 (18種代詞)

3. **✅ 服務器運行中**
   - 後端: http://localhost:8082 ✅
   - 前端: http://localhost:3000 ✅
   - 瀏覽器已打開 ✅

---

## 🧪 測試 1：語音識別驗證（5分鐘）

### 目標
確認新 API Key 能正常工作，語音識別正確

### 步驟

1. **刷新瀏覽器**
   ```
   按 Ctrl + Shift + R
   ```

2. **打開控制台**
   ```
   按 F12
   點擊 Console 標籤
   右鍵 → Clear console
   ```

3. **進入課程並錄音**
   - 登入系統
   - 選擇任意課程（建議 L3）
   - 找到問題：「你叫什麼名字？」
   - **正確朗讀**：「你叫什麼名字」
   - 停止錄音

4. **檢查後端日誌**

   **✅ 成功標準**：
   ```
   🔑 API Key 狀態: 已設定 (AIzaSyBczY...)
   🤖 使用 Gemini 1.5 Flash 進行語音評分
   ✅ Gemini 評分成功
   transcript: "你叫什麼名字"
   ```

   **❌ 失敗標準**：
   ```
   ⚠️ Gemini API 評分失敗 [429]
   📊 使用模擬評分
   transcript: "[模擬STT無法識別真實語音]"
   ```

### 測試其他課程：
4. 返回 Dashboard
5. 點擊 **「L2: Lesson 2」**

### 預期結果：
✅ 頁面載入 L2 的內容（不是 L1）
✅ 標題和內容與 L2.json 對應

---

## 測試 2：台灣腔語音 ✅

### 方法 A - 在課程中測試：
1. 進入任意課程 (例如 L1)
2. 聽自動播放的語音

### 預期結果：
✅ 聽到**台灣腔**的中文（不是大陸腔）
✅ 聲調自然，像母語者
✅ 速度適中（rate: 0.85）
✅ 音調稍高（pitch: 1.05）

### 方法 B - 使用測試頁面：
1. 訪問 http://localhost:3000/test-tw-voice.html
2. 點擊 **「🔊 播放台灣腔」**
3. 點擊 **「🔊 播放大陸腔」** (對比)
4. 點擊 **「📋 列出所有語音」**

### 預期結果：
✅ 看到可用的台灣語音列表（藍色標註）
✅ 顯示當前使用的語音名稱和參數
✅ 可以對比台灣腔和大陸腔的差異

### 建議的台灣語音（按優先順序）：
1. ⭐ Microsoft HsiaoChen - Chinese (Taiwan)
2. ⭐ Microsoft Yating - Chinese (Taiwan)
3. ⭐ Google 國語（臺灣）
4. Mei-Jia
5. Sin-ji
6. Ting-Ting

---

## 測試 3：完成報表生成 ✅

### 步驟：
1. 進入任意課程 (建議選題目較少的)
2. 點擊**藍色錄音按鈕**開始錄音
   - 按鈕變紅色並脈動
   - 顯示「🎤 錄音中...」
3. 再次點擊**停止錄音**
4. 等待評分結果（1-2秒）

### 情況 A - 通過（≥75分）：
✅ 顯示鼓勵語句（例如："很好！"）
✅ 2秒後自動進入下一題
✅ 進度條前進

### 情況 B - 未通過（<75分）：
✅ 背景變黃色
✅ 顯示「💪 再試一次！得分：XX 分」
✅ 2秒後重新播放題目
✅ 可以無限次重試

### 步驟（繼續）：
5. 完成所有題目（通過所有題目）

### 預期結果 - 報表頁面：
✅ 自動顯示「🎉 課程完成報表」
✅ 顯示總體平均分數（大字）
✅ 漸層背景（藍色→紫色）
✅ 顯示每題的詳細分析：
   - 題目內容
   - 得分（顏色標示）
   - 嘗試次數
   - 通過狀態
   - 個人化建議

✅ 三個操作按鈕：
   - 🔄 重新學習
   - 🏠 返回課程列表
   - 📜 查看學習記錄

---

## 測試 4：完整流程測試 ✅

### 完整用戶旅程：
```
1. Dashboard（課程列表）
   ↓ 點擊 L1
2. 課程頁面（L1 內容）
   ↓ 自動播放台灣腔語音
3. 聽完後點擊錄音
   ↓ 錄音並評分
4. 分數 ≥75 → 下一題
   分數 <75 → 重試
   ↓ 重複直到完成
5. 完成報表頁面
   ↓ 查看分析
6. 返回 Dashboard 或重新學習
```

---

## 🐛 常見問題排除

### 問題 1：聽不到台灣腔
**原因：** 系統沒有台灣語音
**解決：**
- 使用 Chrome 或 Edge 瀏覽器
- 訪問測試頁面查看可用語音
- 確認系統語言設定

### 問題 2：無法錄音
**原因：** 麥克風未授權
**解決：**
- 檢查瀏覽器設定
- 允許麥克風權限
- 確認使用 HTTPS 或 localhost

### 問題 3：課程載入錯誤
**原因：** 後端未啟動或 JSON 文件不存在
**解決：**
- 確認後端運行：http://localhost:8082
- 檢查 `apps/backend/src/plugins/chinese-lessons/` 目錄
- 確認 L1.json, L2.json 等文件存在

### 問題 4：報表不顯示
**原因：** 未完成所有題目
**解決：**
- 必須通過所有題目才會顯示報表
- 檢查 `showReport` 狀態

---

## 📊 測試檢查清單

### 核心功能
- [ ] L1 載入 L1 內容 ✅
- [ ] L2 載入 L2 內容 ✅
- [ ] 語音是台灣腔 ✅
- [ ] 自動播放問題 ✅
- [ ] 錄音功能正常 ✅
- [ ] 評分正確（75分機制）✅
- [ ] 通過後進入下一題 ✅
- [ ] 未通過可重試 ✅
- [ ] 完成後顯示報表 ✅

### UI/UX
- [ ] 進度條正確 ✅
- [ ] 錄音按鈕動畫 ✅
- [ ] 重試黃色提示 ✅
- [ ] 報表佈局美觀 ✅
- [ ] 所有按鈕可點擊 ✅

### 數據
- [ ] 每題分數記錄 ✅
- [ ] 嘗試次數記錄 ✅
- [ ] 平均分計算正確 ✅
- [ ] 建議文字正確 ✅

---

## 🎯 測試目標分數

### 各功能權重：
- 課程對應：30%
- 台灣腔語音：30%
- 報表生成：30%
- UI/UX：10%

### 目標：
🎯 **100%** - 所有功能完美運行
✅ **90%+** - 核心功能正常，小問題可忽略
⚠️ **75%+** - 基本可用，需要改進
❌ **<75%** - 需要修復

---

## 📞 測試報告範例

### 測試日期：2025/10/9
### 測試者：[您的名字]

| 功能 | 狀態 | 備註 |
|------|------|------|
| 課程對應 | ✅ PASS | L1-L10 全部正確 |
| 台灣腔語音 | ✅ PASS | 使用 Microsoft HsiaoChen |
| 完成報表 | ✅ PASS | 所有資訊顯示正確 |
| UI/UX | ✅ PASS | 流暢無問題 |

**總評：✅ 100% PASS**

---

## 🚀 開始測試

### 現在就開始：
1. 打開 Chrome 或 Edge
2. 訪問 http://localhost:3000
3. 按照上述步驟測試
4. 享受學習中文！

### 祝測試順利！🎉
