# ğŸ“ Chinese Learning Platform

ä¸€å€‹åŸºæ–¼ AI çš„äº’å‹•å¼ä¸­æ–‡å­¸ç¿’å¹³å°ï¼Œé€éèªéŸ³è­˜åˆ¥å’Œæ™ºèƒ½è©•åˆ†ç³»çµ±ï¼Œå¹«åŠ©å­¸ç¿’è€…æå‡ä¸­æ–‡å£èªèƒ½åŠ›ã€‚

## âœ¨ æ ¸å¿ƒç‰¹è‰²

- ğŸ¯ **æ™ºèƒ½èªéŸ³è©•åˆ†**: ä½¿ç”¨ Google Gemini API é€²è¡Œç²¾ç¢ºçš„ç™¼éŸ³ã€è²èª¿å’Œæµæš¢åº¦è©•ä¼°
- ğŸ—£ï¸ **å³æ™‚èªéŸ³è­˜åˆ¥**: æ”¯æ´èªéŸ³è½‰æ–‡å­—ï¼Œç«‹å³åé¥‹å­¸ç¿’æˆæœ
- ğŸ“Š **å¤šç¶­åº¦åˆ†æ**: å¾ç™¼éŸ³ã€æµæš¢åº¦ã€æº–ç¢ºåº¦ã€ç†è§£åŠ›ç­‰å¤šå€‹ç¶­åº¦è©•ä¼°è¡¨ç¾
- ğŸ“š **çµæ§‹åŒ–èª²ç¨‹**: æŒ‰ç« ç¯€çµ„ç¹”çš„æ¼¸é€²å¼å­¸ç¿’å…§å®¹
- ğŸ¬ **è¦–é »æ•™å­¸**: æ•´åˆ YouTube æ•™å­¸è¦–é »ï¼Œæä¾›è¦–è¦ºåŒ–å­¸ç¿’é«”é©—
- ğŸ“– **æ™ºèƒ½å–®å­—å¡**: è‡ªå‹•æ”¶éŒ„éŒ¯èª¤é¡Œç›®ï¼Œæ”¯æ´åˆ†é¡ç®¡ç†å’Œè¤‡ç¿’
- ğŸ“ˆ **å­¸ç¿’æ­·å²**: å®Œæ•´è¨˜éŒ„å­¸ç¿’éç¨‹ï¼Œè¿½è¹¤é€²æ­¥è»Œè·¡
- ğŸ¨ **ç¾ä»£åŒ–ç•Œé¢**: éŸ¿æ‡‰å¼è¨­è¨ˆï¼Œæ”¯æ´æ¡Œé¢å’Œç§»å‹•è¨­å‚™

## ğŸš€ å¿«é€Ÿé–‹å§‹

### ç’°å¢ƒè¦æ±‚

- Node.js 18+ 
- npm æˆ– yarn
- Google Gemini API Key

### å®‰è£æ­¥é©Ÿ

1. **å…‹éš†å°ˆæ¡ˆ**
```bash
git clone <repository-url>
cd chiness-interview-main
```

2. **å®‰è£ä¾è³´**
```bash
npm install
```

3. **é…ç½®ç’°å¢ƒè®Šæ•¸**

å‰µå»º `apps/backend/.env` æ–‡ä»¶ï¼š
```env
GEMINI_API_KEY=your_gemini_api_key_here
PORT=8082
```

4. **å•Ÿå‹•æœå‹™**

**æ–¹å¼ä¸€ï¼šåŒæ™‚å•Ÿå‹•å‰å¾Œç«¯**
```bash
npm run dev
```

**æ–¹å¼äºŒï¼šåˆ†åˆ¥å•Ÿå‹•**
```bash
# å¾Œç«¯ (Port 8082)
cd apps/backend
npm run dev

# å‰ç«¯ (Port 3000)
cd apps/web
npm run dev
```

5. **è¨ªå•æ‡‰ç”¨**
```
å‰ç«¯: http://localhost:3000
å¾Œç«¯: http://localhost:8082
```

## ğŸ“ å°ˆæ¡ˆæ¶æ§‹

```
chiness-interview-main/
â”œâ”€â”€ apps/
â”‚   â”œâ”€â”€ backend/              # Express + TypeScript å¾Œç«¯
â”‚   â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”‚   â”œâ”€â”€ routes/       # API è·¯ç”±
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ score.ts  # èªéŸ³è©•åˆ†æ¥å£
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ lesson.ts # èª²ç¨‹ç®¡ç†æ¥å£
â”‚   â”‚   â”‚   â”œâ”€â”€ plugins/      # èª²ç¨‹å…§å®¹æ’ä»¶
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ chinese-lessons/
â”‚   â”‚   â”‚   â”‚       â”œâ”€â”€ chapter-1/  # ç¬¬ä¸€ç« èª²ç¨‹
â”‚   â”‚   â”‚   â”‚       â”œâ”€â”€ chapter-2/  # ç¬¬äºŒç« èª²ç¨‹
â”‚   â”‚   â”‚   â”‚       â””â”€â”€ ...
â”‚   â”‚   â”‚   â””â”€â”€ server.ts     # æœå‹™å™¨å…¥å£
â”‚   â”‚   â””â”€â”€ .env              # ç’°å¢ƒè®Šæ•¸é…ç½®
â”‚   â”‚
â”‚   â””â”€â”€ web/                  # Next.js 14 å‰ç«¯
â”‚       â”œâ”€â”€ app/
â”‚       â”‚   â”œâ”€â”€ (protected)/  # å—ä¿è­·è·¯ç”±
â”‚       â”‚   â”‚   â”œâ”€â”€ lesson/[id]/  # èª²ç¨‹å­¸ç¿’é é¢
â”‚       â”‚   â”‚   â”œâ”€â”€ dashboard/    # å„€è¡¨æ¿
â”‚       â”‚   â”‚   â”œâ”€â”€ history/      # å­¸ç¿’æ­·å²
â”‚       â”‚   â”‚   â””â”€â”€ flashcards/   # å–®å­—å¡
â”‚       â”‚   â””â”€â”€ layout.tsx    # å…¨å±€å¸ƒå±€
â”‚       â””â”€â”€ components/       # React çµ„ä»¶
â”‚
â”œâ”€â”€ package.json              # æ ¹å°ˆæ¡ˆé…ç½®
â””â”€â”€ README.md                # æœ¬æ–‡ä»¶
```

## ğŸ® ä¸»è¦åŠŸèƒ½

### 1. èª²ç¨‹å­¸ç¿’ (`/lesson/[id]`)

**æ ¸å¿ƒæµç¨‹ï¼š**
- é¸æ“‡èª²ç¨‹ç« ç¯€
- è½å–é¡Œç›®éŸ³é »æˆ–è§€çœ‹è¦–é »
- éŒ„è£½ç­”æ¡ˆ
- **å³æ™‚è‡ªå‹•è©•åˆ†** - ç„¡å»¶é²ç›´æ¥é€²å…¥ä¸‹ä¸€é¡Œ
- å®Œæˆå¾ŒæŸ¥çœ‹è©³ç´°å ±è¡¨

**è©•åˆ†ç³»çµ±ï¼š**
- æ–‡å­—ç›¸ä¼¼åº¦åˆ†æ
- æ‹¼éŸ³åŒ¹é…æª¢æ¸¬
- è²èª¿æº–ç¢ºåº¦è©•ä¼°
- æ§½ä½æª¢æŸ¥ï¼ˆé—œéµå­—é©—è­‰ï¼‰
- ç¶œåˆå¾—åˆ†è¨ˆç®—

**è‡ªå‹•å‰é€²æ©Ÿåˆ¶ï¼š**
- è©•åˆ†å®Œæˆå¾Œç«‹å³åˆ‡æ›åˆ°ä¸‹ä¸€é¡Œ
- ä¸é¡¯ç¤ºå–®é¡Œåé¥‹é é¢
- å¤±æ•—é¡Œç›®è‡ªå‹•åŠ å…¥å–®å­—å¡
- æ‰€æœ‰é¡Œç›®å®Œæˆå¾Œé¡¯ç¤ºç¸½å ±è¡¨

### 2. å­¸ç¿’å„€è¡¨æ¿ (`/dashboard`)

- æŸ¥çœ‹å¯ç”¨èª²ç¨‹åˆ—è¡¨
- è¿½è¹¤å­¸ç¿’é€²åº¦
- å¿«é€Ÿè¨ªå•æœ€è¿‘èª²ç¨‹

### 3. å­¸ç¿’æ­·å² (`/history`)

- æŸ¥çœ‹æ‰€æœ‰å­¸ç¿’è¨˜éŒ„
- è©³ç´°çš„è©•åˆ†å ±å‘Š
- äº”ç¶­é›·é”åœ–åˆ†æ
- é€é¡Œè¡¨ç¾å›é¡§
- éŒ¯èª¤åˆ†æå’Œæ”¹é€²å»ºè­°

### 4. æ™ºèƒ½å–®å­—å¡ (`/flashcards`)

- è‡ªå‹•æ”¶éŒ„éŒ¯èª¤é¡Œç›®
- åˆ†é¡ç®¡ç†ï¼ˆå¯å‰µå»ºä¸åŒç‰Œçµ„ï¼‰
- è¤‡ç¿’æ¨¡å¼
- åŒ¯å‡º/åŒ¯å…¥åŠŸèƒ½

## ğŸ”§ æŠ€è¡“æ£§

### å‰ç«¯
- **æ¡†æ¶**: Next.js 14 (App Router)
- **èªè¨€**: TypeScript
- **æ¨£å¼**: Tailwind CSS
- **UI çµ„ä»¶**: Lucide React Icons
- **åœ–è¡¨**: Chart.js + react-chartjs-2
- **PDF ç”Ÿæˆ**: jsPDF + html2canvas
- **ä¸­æ–‡è™•ç†**: pinyin-pro

### å¾Œç«¯
- **æ¡†æ¶**: Express.js
- **èªè¨€**: TypeScript
- **AI æœå‹™**: Google Generative AI (Gemini 2.0 Flash)
- **èªéŸ³è™•ç†**: Web Audio API
- **CORS**: cors middleware

### é–‹ç™¼å·¥å…·
- **åŒ…ç®¡ç†**: npm workspaces
- **ä¸¦ç™¼åŸ·è¡Œ**: concurrently
- **TypeScript**: ts-node

## ğŸ“Š è©•åˆ†ç®—æ³•

### ä¸‰ç¶­è©•åˆ†ç³»çµ±

1. **æ–‡å­—ç›¸ä¼¼åº¦ (Text Similarity)**
   - Levenshtein Distance ç®—æ³•
   - æ¨™æº–åŒ–è™•ç†ï¼ˆç§»é™¤æ¨™é»ã€ç©ºæ ¼ï¼‰
   - æ¬Šé‡: 40%

2. **æ‹¼éŸ³ç›¸ä¼¼åº¦ (Phoneme Similarity)**
   - ä¸­æ–‡å­—è½‰æ‹¼éŸ³æ¯”å°
   - æ”¯æ´åŒéŸ³å­—è­˜åˆ¥
   - æ¬Šé‡: 35%

3. **è²èª¿æº–ç¢ºåº¦ (Tone Accuracy)**
   - å››è²åŒ¹é…åº¦åˆ†æ
   - æ‹¼éŸ³è²èª¿è™Ÿé©—è­‰
   - æ¬Šé‡: 25%

### æ§½ä½æª¢æŸ¥ (Slot Check)

- é©—è­‰é—œéµå­—æ˜¯å¦å­˜åœ¨
- æª¢æŸ¥èªç¾©çµæ§‹å®Œæ•´æ€§
- è­˜åˆ¥éºæ¼çš„é‡è¦æˆåˆ†

### æœ€çµ‚åˆ¤å®š

```typescript
ç¶œåˆå¾—åˆ† = (æ–‡å­—ç›¸ä¼¼åº¦ Ã— 0.4) + (æ‹¼éŸ³ç›¸ä¼¼åº¦ Ã— 0.35) + (è²èª¿æº–ç¢ºåº¦ Ã— 0.25)

é€šéæ¢ä»¶:
- ç¶œåˆå¾—åˆ† â‰¥ 70 åˆ†
- æ§½ä½æª¢æŸ¥é€šé
- å¾Œç«¯ AI è©•åˆ† â‰¥ 60 åˆ†
```

## ğŸ¨ èª²ç¨‹å…§å®¹æ ¼å¼

### èª²ç¨‹å®šç¾© (JSON)

```json
{
  "lesson_id": "C1-L01",
  "chapterId": "C1",
  "lessonNumber": 1,
  "title": "Greetings",
  "description": "Learn basic greetings",
  "steps": [
    {
      "id": 1,
      "teacher": "ä½ å¥½",
      "pinyin": ["nÇ hÇo"],
      "expected_answer": ["ä½ å¥½"],
      "video_url": "https://youtube.com/watch?v=...",
      "captions": [
        {
          "start": 0,
          "end": 2,
          "text": "Hello in Chinese"
        }
      ]
    }
  ]
}
```

### æ”¯æ´çš„åŠŸèƒ½

- âœ… å¤šå€‹é æœŸç­”æ¡ˆï¼ˆalternative answersï¼‰
- âœ… æ‹¼éŸ³æ¨™è¨»
- âœ… YouTube è¦–é »æ•´åˆ
- âœ… æ™‚é–“è»¸å­—å¹•
- âœ… TTS èªéŸ³åˆæˆ
- âœ… è¦–é »æ’­æ”¾æ§åˆ¶

## ğŸ” API ç«¯é»

### èª²ç¨‹ç›¸é—œ

```
GET  /api/lessons           # ç²å–æ‰€æœ‰èª²ç¨‹åˆ—è¡¨
GET  /api/lessons/:id       # ç²å–ç‰¹å®šèª²ç¨‹è©³æƒ…
```

### è©•åˆ†ç›¸é—œ

```
POST /api/score             # æäº¤éŒ„éŸ³é€²è¡Œè©•åˆ†
```

**è«‹æ±‚æ ¼å¼ (multipart/form-data):**
- `audio`: éŸ³é »æ–‡ä»¶ (webm/wav)
- `expectedAnswer`: JSON å­—ç¬¦ä¸²æ•¸çµ„
- `questionId`: é¡Œç›® ID
- `lessonId`: èª²ç¨‹ ID

**éŸ¿æ‡‰æ ¼å¼:**
```json
{
  "overall_score": 85,
  "transcript": "ä½ å¥½",
  "feedback": "Great pronunciation!",
  "suggestions": ["Practice tone 3 more", "..."],
  "mispronounced": [
    {
      "text": "å¥½",
      "pinyin": "hao3",
      "issue": "Tone too flat",
      "tip": "Dip down for tone 3"
    }
  ],
  "method": "gemini"
}
```

## ğŸ§ª æ¸¬è©¦

### å¾Œç«¯æ¸¬è©¦
```bash
cd apps/backend
npm test
```

### å‰ç«¯æ¸¬è©¦
```bash
cd apps/web
npm test
```

### Gemini API æ¸¬è©¦
```bash
node test-gemini-scoring.js
```

## ğŸ› å¸¸è¦‹å•é¡Œ

### 1. Port å·²è¢«ä½”ç”¨

**æ¸…é™¤ Port 8082:**
```powershell
Get-NetTCPConnection -LocalPort 8082 | Select-Object -ExpandProperty OwningProcess | ForEach-Object { Stop-Process -Id $_ -Force }
```

**æ¸…é™¤ Port 3000:**
```powershell
Get-NetTCPConnection -LocalPort 3000 | Select-Object -ExpandProperty OwningProcess | ForEach-Object { Stop-Process -Id $_ -Force }
```

### 2. Gemini API éŒ¯èª¤

- ç¢ºèª `.env` æ–‡ä»¶ä¸­çš„ `GEMINI_API_KEY` æ­£ç¢º
- æª¢æŸ¥ API é…é¡æ˜¯å¦è¶³å¤ 
- é©—è­‰ç¶²çµ¡é€£æ¥

### 3. å‰ç«¯ç·¨è­¯éŒ¯èª¤

```bash
cd apps/web
rm -rf .next
npm install
npm run build
```

### 4. éŸ³é »éŒ„è£½å¤±æ•—

- ç¢ºèªç€è¦½å™¨éº¥å…‹é¢¨æ¬Šé™
- ä½¿ç”¨ HTTPS æˆ– localhost
- æª¢æŸ¥éº¥å…‹é¢¨è¨­å‚™ç‹€æ…‹

## ğŸ“ é–‹ç™¼æŒ‡å—

### æ·»åŠ æ–°èª²ç¨‹

1. åœ¨ `apps/backend/src/plugins/chinese-lessons/` å‰µå»ºæ–°ç« ç¯€æ–‡ä»¶å¤¾
2. æ·»åŠ  `lesson-X.json` æ–‡ä»¶
3. æŒ‰ç…§èª²ç¨‹æ ¼å¼å®šç¾©å…§å®¹
4. é‡å•Ÿå¾Œç«¯æœå‹™

### ä¿®æ”¹è©•åˆ†é‚è¼¯

ç·¨è¼¯ `apps/web/app/(protected)/lesson/[id]/page.tsx`:
- `calculateThreeDimensionalScore()` - ä¸‰ç¶­è©•åˆ†
- `checkKeySlots()` - æ§½ä½æª¢æŸ¥
- `judgeScore()` - æœ€çµ‚åˆ¤å®š

### è‡ªå®šç¾© UI ä¸»é¡Œ

ç·¨è¼¯ `apps/web/app/globals.css` å’Œ Tailwind é…ç½®

## ğŸ¤ è²¢ç»

æ­¡è¿æäº¤ Issue å’Œ Pull Requestï¼

## ğŸ“„ æˆæ¬Š

MIT License

## ğŸ‘¥ ä½œè€…

Taiwan Chinese Learning Platform Team

---

**æœ€å¾Œæ›´æ–°**: 2025-11-15
