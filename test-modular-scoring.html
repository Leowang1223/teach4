<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ¯ æ¨¡çµ„åŒ–è©•åˆ†ç³»çµ±æ¸¬è©¦å™¨ V2.0</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        h1 {
            text-align: center;
            color: white;
            margin-bottom: 30px;
            font-size: 2.5em;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .status-bar {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-around;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .status-item {
            text-align: center;
        }

        .status-label {
            font-size: 0.9em;
            color: #666;
            margin-bottom: 5px;
        }

        .status-value {
            font-size: 1.2em;
            font-weight: bold;
        }

        .status-value.success { color: #10b981; }
        .status-value.error { color: #ef4444; }
        .status-value.warning { color: #f59e0b; }

        .test-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .test-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            transition: transform 0.2s;
        }

        .test-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.15);
        }

        .test-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .test-title {
            font-weight: bold;
            font-size: 1.1em;
            color: #1f2937;
        }

        .test-status {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.85em;
            font-weight: 600;
        }

        .test-status.pending {
            background: #e5e7eb;
            color: #6b7280;
        }

        .test-status.running {
            background: #fef3c7;
            color: #d97706;
        }

        .test-status.passed {
            background: #d1fae5;
            color: #059669;
        }

        .test-status.failed {
            background: #fee2e2;
            color: #dc2626;
        }

        .test-details {
            background: #f9fafb;
            padding: 12px;
            border-radius: 8px;
            margin: 10px 0;
            font-size: 0.9em;
        }

        .test-details .label {
            color: #6b7280;
            display: inline-block;
            width: 60px;
        }

        .test-details .value {
            color: #1f2937;
            font-weight: 500;
        }

        .test-button {
            width: 100%;
            padding: 12px;
            border: none;
            border-radius: 8px;
            background: #667eea;
            color: white;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.2s;
            margin-top: 10px;
        }

        .test-button:hover {
            background: #5568d3;
        }

        .test-button:disabled {
            background: #9ca3af;
            cursor: not-allowed;
        }

        .result-panel {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            margin-top: 20px;
        }

        .result-title {
            font-size: 1.3em;
            font-weight: bold;
            margin-bottom: 15px;
            color: #1f2937;
        }

        .result-content {
            background: #1f2937;
            color: #10b981;
            padding: 15px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            line-height: 1.6;
            max-height: 500px;
            overflow-y: auto;
        }

        .error-text { color: #ef4444; }
        .warning-text { color: #f59e0b; }
        .success-text { color: #10b981; }
        .info-text { color: #3b82f6; }

        .control-panel {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .control-button {
            flex: 1;
            padding: 15px;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }

        .btn-primary {
            background: #10b981;
            color: white;
        }

        .btn-primary:hover {
            background: #059669;
        }

        .btn-secondary {
            background: white;
            color: #667eea;
            border: 2px solid #667eea;
        }

        .btn-secondary:hover {
            background: #667eea;
            color: white;
        }

        .btn-danger {
            background: #ef4444;
            color: white;
        }

        .btn-danger:hover {
            background: #dc2626;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ¯ æ¨¡çµ„åŒ–è©•åˆ†ç³»çµ±æ¸¬è©¦å™¨ V2.0</h1>

        <div class="status-bar">
            <div class="status-item">
                <div class="status-label">å¾Œç«¯æœå‹™å™¨</div>
                <div class="status-value" id="backend-status">æª¢æŸ¥ä¸­...</div>
            </div>
            <div class="status-item">
                <div class="status-label">å‰ç«¯æœå‹™å™¨</div>
                <div class="status-value" id="frontend-status">æª¢æŸ¥ä¸­...</div>
            </div>
            <div class="status-item">
                <div class="status-label">æ¸¬è©¦å®Œæˆ</div>
                <div class="status-value" id="test-progress">0/8</div>
            </div>
        </div>

        <div class="control-panel">
            <button class="control-button btn-primary" onclick="runAllTests()">
                ğŸš€ åŸ·è¡Œæ‰€æœ‰æ¸¬è©¦
            </button>
            <button class="control-button btn-secondary" onclick="clearResults()">
                ğŸ—‘ï¸ æ¸…é™¤çµæœ
            </button>
            <button class="control-button btn-danger" onclick="location.reload()">
                ğŸ”„ é‡ç½®é é¢
            </button>
        </div>

        <div class="test-grid" id="test-grid">
            <!-- æ¸¬è©¦æ¡ˆä¾‹å°‡ç”± JavaScript å‹•æ…‹ç”Ÿæˆ -->
        </div>

        <div class="result-panel">
            <div class="result-title">ğŸ“Š æ¸¬è©¦æ—¥èªŒè¼¸å‡º</div>
            <div class="result-content" id="log-output">
                ç­‰å¾…æ¸¬è©¦é–‹å§‹...
            </div>
        </div>
    </div>

    <script>
        const testCases = [
            {
                id: 1,
                name: 'ä»£è©éŒ¯èª¤æ¸¬è©¦ï¼ˆæˆ‘ vs ä½ ï¼‰',
                expected: 'ä½ å«ä»€éº¼åå­—',
                actual: 'æˆ‘å«ä»€éº¼åå­—',
                shouldPass: false,
                maxScore: 50,
                checkSlot: true,
                slotError: 'ä»£è©éŒ¯èª¤'
            },
            {
                id: 2,
                name: 'å®Œå…¨æ­£ç¢ºæ¸¬è©¦',
                expected: 'ä½ å«ä»€éº¼åå­—',
                actual: 'ä½ å«ä»€éº¼åå­—',
                shouldPass: true,
                minScore: 85,
                checkSlot: true
            },
            {
                id: 3,
                name: 'ç¼ºå¤±ä»£è©æ¸¬è©¦',
                expected: 'ä½ å«ä»€éº¼åå­—',
                actual: 'å«ä»€éº¼åå­—',
                shouldPass: false,
                maxScore: 50,
                checkSlot: true,
                slotError: 'ç¼ºå¤±ä»£è©'
            },
            {
                id: 4,
                name: 'å¤šé¤˜ä»£è©æ¸¬è©¦',
                expected: 'å«ä»€éº¼åå­—',
                actual: 'ä½ å«ä»€éº¼åå­—',
                shouldPass: false,
                maxScore: 50,
                checkSlot: true,
                slotError: 'å¤šé¤˜ä»£è©'
            },
            {
                id: 5,
                name: 'ä»£è©éŒ¯èª¤ï¼ˆä»– vs å¥¹ï¼‰',
                expected: 'ä»–æ˜¯èª°',
                actual: 'å¥¹æ˜¯èª°',
                shouldPass: false,
                maxScore: 50,
                checkSlot: true,
                slotError: 'ä»£è©éŒ¯èª¤'
            },
            {
                id: 6,
                name: 'çŸ­å¥é«˜é–€æª»æ¸¬è©¦',
                expected: 'ä½ å¥½',
                actual: 'ä½ å¥½',
                shouldPass: true,
                minScore: 90,
                checkSlot: true
            },
            {
                id: 7,
                name: 'æ¨™æº–å¥é–€æª»æ¸¬è©¦',
                expected: 'æˆ‘ä»Šå¤©å¾ˆé–‹å¿ƒ',
                actual: 'æˆ‘ä»Šå¤©å¾ˆé–‹å¿ƒ',
                shouldPass: true,
                minScore: 85,
                checkSlot: true
            },
            {
                id: 8,
                name: 'æ··åˆéŒ¯èª¤æ¸¬è©¦',
                expected: 'ä½ å’Œä»–éƒ½å¾ˆå¥½',
                actual: 'æˆ‘å’Œå¥¹éƒ½å¾ˆå¥½',
                shouldPass: false,
                maxScore: 50,
                checkSlot: true,
                slotError: 'å¤šè™•ä»£è©éŒ¯èª¤'
            }
        ];

        let testResults = [];
        let logMessages = [];

        function log(message, type = 'info') {
            const timestamp = new Date().toLocaleTimeString();
            const colorClass = {
                'error': 'error-text',
                'warning': 'warning-text',
                'success': 'success-text',
                'info': 'info-text'
            }[type] || 'info-text';
            
            logMessages.push(`<span class="${colorClass}">[${timestamp}] ${message}</span>`);
            document.getElementById('log-output').innerHTML = logMessages.join('<br>');
            document.getElementById('log-output').scrollTop = document.getElementById('log-output').scrollHeight;
        }

        function clearResults() {
            testResults = [];
            logMessages = [];
            document.getElementById('log-output').innerHTML = 'å·²æ¸…é™¤çµæœ';
            document.querySelectorAll('.test-status').forEach(el => {
                el.className = 'test-status pending';
                el.textContent = 'å¾…æ¸¬è©¦';
            });
            updateProgress();
        }

        function updateProgress() {
            const completed = testResults.filter(r => r.completed).length;
            document.getElementById('test-progress').textContent = `${completed}/${testCases.length}`;
        }

        async function checkServerStatus() {
            try {
                const response = await fetch('http://localhost:8082/health', { method: 'GET' });
                document.getElementById('backend-status').textContent = 'âœ… é‹è¡Œä¸­';
                document.getElementById('backend-status').className = 'status-value success';
            } catch {
                document.getElementById('backend-status').textContent = 'âŒ é›¢ç·š';
                document.getElementById('backend-status').className = 'status-value error';
            }

            try {
                const response = await fetch('http://localhost:3000', { method: 'HEAD' });
                document.getElementById('frontend-status').textContent = 'âœ… é‹è¡Œä¸­';
                document.getElementById('frontend-status').className = 'status-value success';
            } catch {
                document.getElementById('frontend-status').textContent = 'âŒ é›¢ç·š';
                document.getElementById('frontend-status').className = 'status-value error';
            }
        }

        function renderTestCases() {
            const grid = document.getElementById('test-grid');
            grid.innerHTML = testCases.map(tc => `
                <div class="test-card" id="card-${tc.id}">
                    <div class="test-header">
                        <div class="test-title">${tc.name}</div>
                        <div class="test-status pending" id="status-${tc.id}">å¾…æ¸¬è©¦</div>
                    </div>
                    <div class="test-details">
                        <div><span class="label">é æœŸï¼š</span><span class="value">${tc.expected}</span></div>
                        <div><span class="label">å¯¦éš›ï¼š</span><span class="value">${tc.actual}</span></div>
                        <div><span class="label">æ‡‰é€šéï¼š</span><span class="value">${tc.shouldPass ? 'âœ… æ˜¯' : 'âŒ å¦'}</span></div>
                    </div>
                    <button class="test-button" onclick="runSingleTest(${tc.id})">
                        â–¶ï¸ åŸ·è¡Œæ­¤æ¸¬è©¦
                    </button>
                </div>
            `).join('');
        }

        async function runSingleTest(id) {
            const testCase = testCases.find(tc => tc.id === id);
            const statusEl = document.getElementById(`status-${id}`);
            
            statusEl.className = 'test-status running';
            statusEl.textContent = 'æ¸¬è©¦ä¸­...';
            
            log(`\n${'='.repeat(60)}`, 'info');
            log(`ğŸ§ª é–‹å§‹æ¸¬è©¦ #${id}: ${testCase.name}`, 'info');
            log(`é æœŸ: "${testCase.expected}"`, 'info');
            log(`å¯¦éš›: "${testCase.actual}"`, 'info');
            log('='.repeat(60), 'info');

            // æ¨¡æ“¬æ¸¬è©¦é‚è¼¯ï¼ˆå¯¦éš›æ‡‰èª¿ç”¨çœŸå¯¦ APIï¼‰
            await new Promise(resolve => setTimeout(resolve, 500));

            // é€™è£¡æ‡‰è©²èª¿ç”¨çœŸå¯¦çš„è©•åˆ† API
            const mockResult = {
                passed: testCase.shouldPass,
                score: testCase.shouldPass ? (testCase.minScore || 90) : (testCase.maxScore || 50),
                slotValid: testCase.shouldPass,
                slotErrors: testCase.shouldPass ? [] : [testCase.slotError || 'æ§½ä½éŒ¯èª¤']
            };

            const testPassed = mockResult.passed === testCase.shouldPass;
            
            if (testPassed) {
                statusEl.className = 'test-status passed';
                statusEl.textContent = 'âœ… é€šé';
                log(`âœ… æ¸¬è©¦é€šéï¼åˆ†æ•¸: ${mockResult.score}`, 'success');
            } else {
                statusEl.className = 'test-status failed';
                statusEl.textContent = 'âŒ å¤±æ•—';
                log(`âŒ æ¸¬è©¦å¤±æ•—ï¼é æœŸ ${testCase.shouldPass ? 'é€šé' : 'å¤±æ•—'}ï¼Œå¯¦éš› ${mockResult.passed ? 'é€šé' : 'å¤±æ•—'}`, 'error');
            }

            if (!mockResult.slotValid) {
                log(`âš ï¸ æ§½ä½æª¢æŸ¥å¤±æ•—: ${mockResult.slotErrors.join(', ')}`, 'warning');
            }

            testResults[id] = { completed: true, passed: testPassed };
            updateProgress();
        }

        async function runAllTests() {
            log('ğŸš€ é–‹å§‹åŸ·è¡Œæ‰€æœ‰æ¸¬è©¦...', 'info');
            for (const tc of testCases) {
                await runSingleTest(tc.id);
                await new Promise(resolve => setTimeout(resolve, 300));
            }
            log('\nâœ… æ‰€æœ‰æ¸¬è©¦å®Œæˆï¼', 'success');
        }

        // åˆå§‹åŒ–
        window.onload = () => {
            renderTestCases();
            checkServerStatus();
            setInterval(checkServerStatus, 5000);
        };
    </script>
</body>
</html>
