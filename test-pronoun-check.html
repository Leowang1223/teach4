<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä»£è©æª¢æ¸¬è‡ªå‹•æ¸¬è©¦</title>
    <style>
        body {
            font-family: 'Microsoft JhengHei', Arial, sans-serif;
            max-width: 1200px;
            margin: 20px auto;
            padding: 20px;
            background: #f5f5f5;
        }
        h1 {
            color: #2c3e50;
            text-align: center;
        }
        .test-case {
            background: white;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .test-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 2px solid #eee;
        }
        .test-title {
            font-size: 18px;
            font-weight: bold;
            color: #34495e;
        }
        .test-status {
            padding: 5px 15px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 14px;
        }
        .status-pass {
            background: #2ecc71;
            color: white;
        }
        .status-fail {
            background: #e74c3c;
            color: white;
        }
        .test-content {
            margin: 10px 0;
        }
        .test-row {
            display: flex;
            padding: 8px;
            margin: 5px 0;
        }
        .test-label {
            width: 120px;
            font-weight: bold;
            color: #7f8c8d;
        }
        .test-value {
            flex: 1;
            font-family: 'Courier New', monospace;
        }
        .expected-value {
            color: #27ae60;
        }
        .actual-value {
            color: #3498db;
        }
        .error-value {
            color: #e74c3c;
            font-weight: bold;
        }
        .console-output {
            background: #2c3e50;
            color: #ecf0f1;
            padding: 15px;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            max-height: 300px;
            overflow-y: auto;
            white-space: pre-wrap;
            margin-top: 10px;
        }
        .summary {
            background: #3498db;
            color: white;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            text-align: center;
        }
        .summary h2 {
            margin: 0 0 10px 0;
        }
        .summary-stats {
            display: flex;
            justify-content: space-around;
            margin-top: 15px;
        }
        .stat {
            text-align: center;
        }
        .stat-number {
            font-size: 36px;
            font-weight: bold;
        }
        .stat-label {
            font-size: 14px;
            opacity: 0.9;
        }
        button {
            background: #3498db;
            color: white;
            border: none;
            padding: 12px 30px;
            font-size: 16px;
            border-radius: 5px;
            cursor: pointer;
            display: block;
            margin: 20px auto;
        }
        button:hover {
            background: #2980b9;
        }
        button:active {
            transform: scale(0.98);
        }
    </style>
</head>
<body>
    <h1>ğŸ§ª ä»£è©æª¢æ¸¬è‡ªå‹•æ¸¬è©¦å·¥å…·</h1>
    <button onclick="runAllTests()">â–¶ï¸ åŸ·è¡Œæ‰€æœ‰æ¸¬è©¦</button>
    <div id="summary"></div>
    <div id="results"></div>

    <script>
        // ğŸ”§ ä»£è©é›†åˆï¼ˆèˆ‡å¯¦éš›ä»£ç¢¼ä¸€è‡´ï¼‰
        const PRONOUNS = new Set([
            // ç¬¬ä¸€äººç¨±
            'æˆ‘', 'ä¿º', 'å’±', 'å’±å€‘', 'å’±ä»¬', 'å¾',
            // ç¬¬äºŒäººç¨±
            'ä½ ', 'æ‚¨', 'å¦³', 'å„‚', 'ä¾¬', 'æ±',
            // ç¬¬ä¸‰äººç¨±
            'ä»–', 'å¥¹', 'å®ƒ', 'ç‰ ', 'ç¥‚', 'ä¼Š'
        ]);

        // ğŸ”§ æ§½ä½æª¢æŸ¥å‡½æ•¸ï¼ˆèˆ‡å¯¦éš›ä»£ç¢¼ä¸€è‡´ï¼‰
        function checkKeySlots(expected, actual) {
            const errors = [];
            const mismatchPositions = [];
            let consoleLog = [];
            
            // Step 1: æ¸…ç†æ–‡æœ¬
            const cleanExpected = expected
                .replace(/[ï¼Œã€‚ï¼ï¼Ÿï¼›ï¼šã€""''ï¼ˆï¼‰ã€Šã€‹ã€ã€‘\s]/g, '')
                .replace(/[,\.!?;:"'\(\)\[\]\s]/g, '');
            
            const cleanActual = actual
                .replace(/[ï¼Œã€‚ï¼ï¼Ÿï¼›ï¼šã€""''ï¼ˆï¼‰ã€Šã€‹ã€ã€‘\s]/g, '')
                .replace(/[,\.!?;:"'\(\)\[\]\s]/g, '');
            
            // Step 2: è½‰ç‚ºå­—ç¬¦æ•¸çµ„
            const expChars = Array.from(cleanExpected);
            const actChars = Array.from(cleanActual);
            
            consoleLog.push('â”'.repeat(80));
            consoleLog.push('ğŸ” ã€æ§½ä½æª¢æŸ¥ã€‘CHARACTER-BY-CHARACTER POSITION CHECK');
            consoleLog.push('â”'.repeat(80));
            consoleLog.push(`ğŸ“ åŸå§‹é æœŸæ–‡æœ¬: ${expected}`);
            consoleLog.push(`ğŸ“ åŸå§‹å¯¦éš›æ–‡æœ¬: ${actual}`);
            consoleLog.push(`ğŸ§¹ æ¸…ç†å¾Œé æœŸ: ${cleanExpected}`);
            consoleLog.push(`ğŸ§¹ æ¸…ç†å¾Œå¯¦éš›: ${cleanActual}`);
            consoleLog.push(`ğŸ“Š å­—ç¬¦æ•¸é‡: é æœŸ=${expChars.length} å¯¦éš›=${actChars.length}`);
            consoleLog.push('â”'.repeat(80));
            
            // Step 3: é€å­—ç¬¦æª¢æŸ¥
            const maxLen = Math.max(expChars.length, actChars.length);
            let pronounCheckCount = 0;
            let pronounErrorCount = 0;
            
            for (let i = 0; i < maxLen; i++) {
                const expChar = expChars[i] || '';
                const actChar = actChars[i] || '';
                
                const expIsPronoun = PRONOUNS.has(expChar);
                const actIsPronoun = PRONOUNS.has(actChar);
                
                if (expIsPronoun || actIsPronoun) {
                    pronounCheckCount++;
                    consoleLog.push('');
                    consoleLog.push(`[ä½ç½® ${i}] ğŸ¯ ä»£è©é—œéµä½ç½®æª¢æŸ¥:`);
                    consoleLog.push(`  é æœŸ: "${expChar}" ${expIsPronoun ? '(âœ“ æ˜¯ä»£è©)' : '(âœ— éä»£è©)'}`);
                    consoleLog.push(`  å¯¦éš›: "${actChar}" ${actIsPronoun ? '(âœ“ æ˜¯ä»£è©)' : '(âœ— éä»£è©)'}`);
                    
                    if (expIsPronoun && !actChar) {
                        const error = `ä½ç½® ${i}: ç¼ºå°‘ä»£è© "${expChar}"`;
                        errors.push(error);
                        mismatchPositions.push(i);
                        pronounErrorCount++;
                        consoleLog.push(`  âŒâŒâŒ åš´é‡éŒ¯èª¤: ç¼ºå°‘å¿…éœ€çš„ä»£è© "${expChar}"`);
                    } else if (expIsPronoun && actChar && !actIsPronoun) {
                        const error = `ä½ç½® ${i}: é æœŸä»£è© "${expChar}"ï¼Œå¯¦éš›æ˜¯éä»£è© "${actChar}"`;
                        errors.push(error);
                        mismatchPositions.push(i);
                        pronounErrorCount++;
                        consoleLog.push(`  âŒâŒâŒ åš´é‡éŒ¯èª¤: æ‡‰è©²æ˜¯ä»£è©ï¼Œå»èªªæˆäº†å…¶ä»–å­—`);
                        consoleLog.push(`      â†’ é æœŸ: "${expChar}" (ä»£è©)`);
                        consoleLog.push(`      â†’ å¯¦éš›: "${actChar}" (ä¸æ˜¯ä»£è©)`);
                    } else if (expIsPronoun && actIsPronoun && expChar !== actChar) {
                        const error = `ä½ç½® ${i}: ä»£è©ä¸åŒ¹é… - é æœŸ "${expChar}"ï¼Œå¯¦éš› "${actChar}"`;
                        errors.push(error);
                        mismatchPositions.push(i);
                        pronounErrorCount++;
                        consoleLog.push(`  âŒâŒâŒ è‡´å‘½éŒ¯èª¤: ä»£è©å®Œå…¨éŒ¯èª¤ï¼`);
                        consoleLog.push(`      â†’ é æœŸä»£è©: "${expChar}"`);
                        consoleLog.push(`      â†’ å¯¦éš›ä»£è©: "${actChar}"`);
                        consoleLog.push(`      â†’ é€™æœƒæ”¹è®Šå¥å­çš„ä¸»èª/è³“èªï¼Œæ„æ€å®Œå…¨ä¸åŒï¼`);
                        consoleLog.push(`      â†’ ä¾‹å¦‚: "ä½ " vs "æˆ‘" æœƒè®“å•å¥è®Šæˆé™³è¿°å¥`);
                    } else if (!expIsPronoun && actIsPronoun) {
                        const error = `ä½ç½® ${i}: ä¸æ‡‰è©²æœ‰ä»£è©ï¼Œå»å‡ºç¾äº† "${actChar}"`;
                        errors.push(error);
                        mismatchPositions.push(i);
                        pronounErrorCount++;
                        consoleLog.push(`  âŒâŒâŒ éŒ¯èª¤: å¤šé¤˜çš„ä»£è© "${actChar}"`);
                        consoleLog.push(`      â†’ é æœŸ: "${expChar || '(ç„¡å­—ç¬¦)'}"`);
                        consoleLog.push(`      â†’ å¯¦éš›: "${actChar}" (å¤šé¤˜çš„ä»£è©)`);
                    } else if (expIsPronoun && actIsPronoun && expChar === actChar) {
                        consoleLog.push(`  âœ…âœ…âœ… å®Œç¾: ä»£è© "${expChar}" ä½ç½®å’Œå…§å®¹ 100% æ­£ç¢º`);
                    }
                }
            }
            
            const valid = errors.length === 0 && pronounErrorCount === 0;
            
            consoleLog.push('');
            consoleLog.push('â”'.repeat(80));
            consoleLog.push('ğŸ“Š ã€æ§½ä½æª¢æŸ¥çµæœã€‘');
            consoleLog.push('â”'.repeat(80));
            consoleLog.push(`  âœ“ æª¢æŸ¥çš„ä»£è©ä½ç½®æ•¸: ${pronounCheckCount}`);
            consoleLog.push(`  âœ— ä»£è©éŒ¯èª¤æ•¸: ${pronounErrorCount}`);
            consoleLog.push(`  âœ— ç¸½éŒ¯èª¤æ•¸: ${errors.length}`);
            consoleLog.push(`  âœ— éŒ¯èª¤ä½ç½®: ${mismatchPositions.length > 0 ? '[' + mismatchPositions.join(', ') + ']' : 'ç„¡'}`);
            consoleLog.push(`  ğŸ¯ æœ€çµ‚åˆ¤å®š: ${valid ? 'âœ…âœ…âœ… VALID (é€šé)' : 'âŒâŒâŒ INVALID (å¤±æ•—)'}`);
            
            if (!valid) {
                consoleLog.push('');
                consoleLog.push('âš ï¸  ã€éŒ¯èª¤è©³æƒ…åˆ—è¡¨ã€‘');
                errors.forEach((err, idx) => {
                    consoleLog.push(`  ${idx + 1}. ${err}`);
                });
                consoleLog.push('');
                consoleLog.push('ğŸ’¡ æç¤º: ä»£è©éŒ¯èª¤æœƒå°è‡´å¥å­æ„æ€å®Œå…¨æ”¹è®Šï¼Œå¿…é ˆé‡æ–°éŒ„éŸ³ï¼');
            }
            
            consoleLog.push('â”'.repeat(80));
            
            return {
                valid,
                errors,
                mismatchPositions,
                consoleLog: consoleLog.join('\n')
            };
        }

        // ğŸ§ª æ¸¬è©¦æ¡ˆä¾‹
        const testCases = [
            {
                name: 'æ¸¬è©¦ 1: ä»£è©éŒ¯èª¤ "æˆ‘" vs "ä½ "',
                expected: 'ä½ å«ä»€éº¼åå­—',
                actual: 'æˆ‘å«ä»€éº¼åå­—',
                shouldPass: false,
                description: 'æœ€å¸¸è¦‹çš„ä»£è©éŒ¯èª¤ï¼Œå¿…é ˆæª¢æ¸¬åˆ°ä¸¦å¤±æ•—'
            },
            {
                name: 'æ¸¬è©¦ 2: å®Œå…¨æ­£ç¢º',
                expected: 'ä½ å«ä»€éº¼åå­—',
                actual: 'ä½ å«ä»€éº¼åå­—',
                shouldPass: true,
                description: 'å®Œå…¨æ­£ç¢ºçš„ç­”æ¡ˆæ‡‰è©²é€šé'
            },
            {
                name: 'æ¸¬è©¦ 3: ç¼ºå°‘ä»£è©',
                expected: 'ä½ å¥½å—',
                actual: 'å¥½å—',
                shouldPass: false,
                description: 'ç¼ºå°‘å¿…éœ€çš„ä»£è©æ‡‰è©²å¤±æ•—'
            },
            {
                name: 'æ¸¬è©¦ 4: å¤šé¤˜ä»£è©',
                expected: 'å«ä»€éº¼åå­—',
                actual: 'ä½ å«ä»€éº¼åå­—',
                shouldPass: false,
                description: 'å¤šäº†ä¸è©²æœ‰çš„ä»£è©æ‡‰è©²å¤±æ•—'
            },
            {
                name: 'æ¸¬è©¦ 5: ä»–/å¥¹/å®ƒ',
                expected: 'ä»–æ˜¯èª°',
                actual: 'å¥¹æ˜¯èª°',
                shouldPass: false,
                description: 'ç¬¬ä¸‰äººç¨±ä»£è©éŒ¯èª¤ä¹Ÿè¦æª¢æ¸¬'
            },
            {
                name: 'æ¸¬è©¦ 6: åŒ…å«æ¨™é»ç¬¦è™Ÿ',
                expected: 'ä½ å¥½å—ï¼Ÿ',
                actual: 'æˆ‘å¥½å—',
                shouldPass: false,
                description: 'å³ä½¿æœ‰æ¨™é»ç¬¦è™Ÿä¹Ÿè¦æ­£ç¢ºæª¢æ¸¬ä»£è©éŒ¯èª¤'
            },
            {
                name: 'æ¸¬è©¦ 7: æ‚¨ï¼ˆæ•¬èªï¼‰',
                expected: 'æ‚¨å¥½',
                actual: 'ä½ å¥½',
                shouldPass: false,
                description: 'æ‚¨å’Œä½ æ˜¯ä¸åŒçš„ä»£è©ï¼Œæ‡‰è©²æª¢æ¸¬åˆ°'
            },
            {
                name: 'æ¸¬è©¦ 8: å®Œå…¨æ­£ç¢ºï¼ˆæ•¬èªï¼‰',
                expected: 'æ‚¨å¥½',
                actual: 'æ‚¨å¥½',
                shouldPass: true,
                description: 'ä½¿ç”¨æ­£ç¢ºçš„æ•¬èªæ‡‰è©²é€šé'
            }
        ];

        // åŸ·è¡Œæ‰€æœ‰æ¸¬è©¦
        function runAllTests() {
            const resultsDiv = document.getElementById('results');
            const summaryDiv = document.getElementById('summary');
            resultsDiv.innerHTML = '';
            
            let passed = 0;
            let failed = 0;
            
            testCases.forEach((testCase, index) => {
                const result = checkKeySlots(testCase.expected, testCase.actual);
                const testPassed = (result.valid === testCase.shouldPass);
                
                if (testPassed) {
                    passed++;
                } else {
                    failed++;
                }
                
                const testDiv = document.createElement('div');
                testDiv.className = 'test-case';
                testDiv.innerHTML = `
                    <div class="test-header">
                        <div class="test-title">${testCase.name}</div>
                        <div class="test-status ${testPassed ? 'status-pass' : 'status-fail'}">
                            ${testPassed ? 'âœ… é€šé' : 'âŒ å¤±æ•—'}
                        </div>
                    </div>
                    <div class="test-content">
                        <div class="test-row">
                            <div class="test-label">èªªæ˜ï¼š</div>
                            <div class="test-value">${testCase.description}</div>
                        </div>
                        <div class="test-row">
                            <div class="test-label">é æœŸæ–‡æœ¬ï¼š</div>
                            <div class="test-value expected-value">"${testCase.expected}"</div>
                        </div>
                        <div class="test-row">
                            <div class="test-label">å¯¦éš›æ–‡æœ¬ï¼š</div>
                            <div class="test-value actual-value">"${testCase.actual}"</div>
                        </div>
                        <div class="test-row">
                            <div class="test-label">é æœŸçµæœï¼š</div>
                            <div class="test-value">${testCase.shouldPass ? 'âœ… æ‡‰è©²é€šé' : 'âŒ æ‡‰è©²å¤±æ•—'}</div>
                        </div>
                        <div class="test-row">
                            <div class="test-label">å¯¦éš›çµæœï¼š</div>
                            <div class="test-value ${result.valid === testCase.shouldPass ? 'expected-value' : 'error-value'}">
                                ${result.valid ? 'âœ… é€šéæ§½ä½æª¢æŸ¥' : 'âŒ æœªé€šéæ§½ä½æª¢æŸ¥'}
                                ${testPassed ? '' : ' âš ï¸ ä¸ç¬¦åˆé æœŸï¼'}
                            </div>
                        </div>
                        ${result.errors.length > 0 ? `
                        <div class="test-row">
                            <div class="test-label">æª¢æ¸¬åˆ°çš„éŒ¯èª¤ï¼š</div>
                            <div class="test-value error-value">
                                ${result.errors.map((e, i) => `${i + 1}. ${e}`).join('<br>')}
                            </div>
                        </div>
                        ` : ''}
                        <div class="console-output">${result.consoleLog}</div>
                    </div>
                `;
                resultsDiv.appendChild(testDiv);
            });
            
            // é¡¯ç¤ºç¸½çµ
            const totalTests = testCases.length;
            const passRate = ((passed / totalTests) * 100).toFixed(1);
            
            summaryDiv.innerHTML = `
                <div class="summary">
                    <h2>ğŸ“Š æ¸¬è©¦çµæœç¸½çµ</h2>
                    <div class="summary-stats">
                        <div class="stat">
                            <div class="stat-number">${totalTests}</div>
                            <div class="stat-label">ç¸½æ¸¬è©¦æ•¸</div>
                        </div>
                        <div class="stat">
                            <div class="stat-number" style="color: #2ecc71;">${passed}</div>
                            <div class="stat-label">é€šé</div>
                        </div>
                        <div class="stat">
                            <div class="stat-number" style="color: #e74c3c;">${failed}</div>
                            <div class="stat-label">å¤±æ•—</div>
                        </div>
                        <div class="stat">
                            <div class="stat-number">${passRate}%</div>
                            <div class="stat-label">é€šéç‡</div>
                        </div>
                    </div>
                    <p style="margin-top: 20px; font-size: 18px;">
                        ${passed === totalTests ? 
                            'ğŸ‰ å®Œç¾ï¼æ‰€æœ‰æ¸¬è©¦éƒ½é€šéäº†ï¼' : 
                            `âš ï¸ é‚„æœ‰ ${failed} å€‹æ¸¬è©¦å¤±æ•—ï¼Œéœ€è¦ä¿®å¾©`
                        }
                    </p>
                </div>
            `;
            
            // æ»¾å‹•åˆ°é ‚éƒ¨
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // é é¢è¼‰å…¥æ™‚è‡ªå‹•åŸ·è¡Œæ¸¬è©¦
        window.addEventListener('load', () => {
            setTimeout(runAllTests, 500);
        });
    </script>
</body>
</html>
